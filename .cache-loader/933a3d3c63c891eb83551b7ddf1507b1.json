{"remainingRequest":"/Users/serqeycheremisin/ieltof/node_modules/babel-loader/lib/index.js!/Users/serqeycheremisin/ieltof/src/components/UserPage/index.js","dependencies":[{"path":"/Users/serqeycheremisin/ieltof/src/components/UserPage/index.js","mtime":1526149638772},{"path":"/Users/serqeycheremisin/ieltof/.babelrc","mtime":1523141114949},{"path":"/Users/serqeycheremisin/ieltof/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/serqeycheremisin/ieltof/node_modules/babel-loader/lib/index.js","mtime":1520329890000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _UserPage = require(\"./UserPage.css\");\n\nvar _UserPage2 = _interopRequireDefault(_UserPage);\n\nvar _classnames = require(\"classnames\");\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _ChatPage = require(\"components/ChatPage\");\n\nvar _ChatPage2 = _interopRequireDefault(_ChatPage);\n\nvar _Community = require(\"components/Community\");\n\nvar _Community2 = _interopRequireDefault(_Community);\n\nvar _Tests = require(\"components/Tests\");\n\nvar _Tests2 = _interopRequireDefault(_Tests);\n\nvar _MainServices = require(\"../../services/MainServices\");\n\nvar MainServices = _interopRequireWildcard(_MainServices);\n\nvar _UserServices = require(\"../../services/UserServices\");\n\nvar UserServices = _interopRequireWildcard(_UserServices);\n\nvar _UserStore = require(\"../../stores/UserStore\");\n\nvar _UserStore2 = _interopRequireDefault(_UserStore);\n\nvar _dispatcher = require(\"../../dispatcher\");\n\nvar _dispatcher2 = _interopRequireDefault(_dispatcher);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar UserPage = function (_React$Component) {\n    _inherits(UserPage, _React$Component);\n\n    function UserPage(props) {\n        _classCallCheck(this, UserPage);\n\n        var _this = _possibleConstructorReturn(this, (UserPage.__proto__ || Object.getPrototypeOf(UserPage)).call(this, props));\n\n        _this.state = _this.props;\n        _this.state.avatar = \"\";\n        _this.state.tab = _react2.default.createElement(\n            \"div\",\n            { className: (0, _classnames2.default)(_defineProperty({}, _UserPage2.default.container_app, true)) },\n            _react2.default.createElement(_Community2.default, null)\n        );\n        console.log(_this.state.user.name);\n\n        _this.socket = new WebSocket(\"wss://cheremisin.info/api/v1/user\");\n        // this.socket = new WebSocket(\"ws://127.0.0.1:8080/api/v1/user\");\n        return _this;\n    }\n\n    _createClass(UserPage, [{\n        key: \"componentDidMount\",\n        value: function componentDidMount() {\n            var _this2 = this;\n\n            window.FB.api(\"/me/picture\", {\n                \"redirect\": false,\n                \"type\": \"large\"\n            }, function (response) {\n                console.log(response);\n                console.log(response.data.url);\n                _this2.state.avatar = response.data.url;\n\n                UserServices.getUser(_this2.state);\n                _this2.setState({});\n                if (response && !response.error) {\n                    /* handle the result */\n                }\n            });\n\n            this.socket.onopen = function () {\n                console.log(\"Соединение установлено.\");\n            };\n\n            this.socket.onclose = function (event) {\n                if (event.wasClean) {\n                    console.log('Соединение закрыто чисто');\n                } else {\n                    console.log('Обрыв соединения');\n                }\n                console.log('Код: ' + event.code + ' причина: ' + event.reason);\n            };\n\n            this.socket.onerror = function (error) {\n                console.log(\"Ошибка \" + error.message);\n            };\n\n            this.socket.onmessage = function (event) {\n                console.log(\"Получены данные \" + event.data);\n                var message = JSON.parse(event.data);\n                console.log(\"event\" + event.data);\n\n                switch (message.action) {\n                    case 'initMessage':\n                        break;\n\n                    case 'sendMessage':\n                        message.body.Text = message.body.Text.replace(/''/g, \"'\");\n                        _dispatcher2.default.dispatch({\n                            type: \"REVIEVE_NEW_MESSAGE\",\n                            message: message.body\n                        });\n                        break;\n                }\n            };\n        }\n    }, {\n        key: \"componentWillMount\",\n        value: function componentWillMount() {\n            _UserStore2.default.on(\"get_user_event\", this.onGetUserEvent.bind(this));\n        }\n    }, {\n        key: \"componentWillUnmount\",\n        value: function componentWillUnmount() {\n            _UserStore2.default.removeListener(\"get_user_event\", this.onGetUserEvent.bind(this));\n        }\n    }, {\n        key: \"onGetUserEvent\",\n        value: function onGetUserEvent() {\n            var profile = _UserStore2.default.getProfile();\n            var message = {\n                type: \"initMessage\",\n                action: \"initMessage\",\n                body: {\n                    user_id: profile.Id\n                }\n            };\n            this.socket.send(JSON.stringify(message));\n\n            UserServices.getFriends();\n            UserServices.getOnlineUsers();\n        }\n    }, {\n        key: \"facebookLogout\",\n        value: function facebookLogout() {\n            MainServices.facebookLogout();\n        }\n    }, {\n        key: \"openCommunity\",\n        value: function openCommunity() {\n            this.state.tab = _react2.default.createElement(\n                \"div\",\n                { className: (0, _classnames2.default)(_defineProperty({}, _UserPage2.default.container_app, true)) },\n                _react2.default.createElement(_Community2.default, null)\n            );\n            this.setState({});\n        }\n    }, {\n        key: \"openMessages\",\n        value: function openMessages() {\n            this.state.tab = _react2.default.createElement(\n                \"div\",\n                { className: (0, _classnames2.default)(_defineProperty({ \"container-app\": true }, _UserPage2.default.container_app_inbox, true)) },\n                _react2.default.createElement(_ChatPage2.default, { socket: this.socket })\n            );\n            this.setState({});\n        }\n    }, {\n        key: \"openTests\",\n        value: function openTests() {\n            this.state.tab = _react2.default.createElement(\n                \"div\",\n                { className: (0, _classnames2.default)(_defineProperty({}, _UserPage2.default.container_app, true)) },\n                _react2.default.createElement(_Tests2.default, null)\n            );\n            this.setState({});\n        }\n    }, {\n        key: \"render\",\n        value: function render() {\n            return _react2.default.createElement(\n                \"div\",\n                null,\n                _react2.default.createElement(\n                    \"navbar\",\n                    null,\n                    _react2.default.createElement(\n                        \"div\",\n                        { className: _UserPage2.default.navbar_content },\n                        _react2.default.createElement(\n                            \"div\",\n                            { className: _UserPage2.default.navbar_content_main },\n                            _react2.default.createElement(\n                                \"div\",\n                                { className: _UserPage2.default.porfile_navbar },\n                                _react2.default.createElement(\n                                    \"a\",\n                                    null,\n                                    _react2.default.createElement(\"img\", { className: _UserPage2.default.profile_picture_navbar, src: this.state.avatar })\n                                ),\n                                _react2.default.createElement(\n                                    \"div\",\n                                    { className: (0, _classnames2.default)(_defineProperty({ \"dropdown\": true }, _UserPage2.default.name_navbar, true)) },\n                                    _react2.default.createElement(\n                                        \"a\",\n                                        { className: _UserPage2.default.name_profile_button, style: { color: \"#fff\" }, type: \"button\",\n                                            id: \"dropdownMenu1\", \"data-toggle\": \"dropdown\", \"aria-haspopup\": \"true\",\n                                            \"aria-expanded\": \"true\" },\n                                        _react2.default.createElement(\n                                            \"div\",\n                                            { className: _UserPage2.default.bold, style: {\n                                                    overflow: 'hidden',\n                                                    whiteSpace: 'nowrap',\n                                                    textOverflow: 'ellipsis'\n                                                } },\n                                            this.state.user.name,\n                                            \" \",\n                                            _react2.default.createElement(\"i\", { className: (0, _classnames2.default)(_defineProperty({\n                                                    \"fa\": true,\n                                                    \"fa-caret-down\": true\n                                                }, _UserPage2.default.fa_caret_down, true)) })\n                                        )\n                                    ),\n                                    _react2.default.createElement(\n                                        \"ul\",\n                                        { className: (0, _classnames2.default)({ \"dropdown-menu\": true }), \"aria-labelledby\": \"dropdownMenu1\" },\n                                        _react2.default.createElement(\n                                            \"li\",\n                                            null,\n                                            _react2.default.createElement(\n                                                \"a\",\n                                                { logout: \"\", onClick: this.facebookLogout.bind(this) },\n                                                \"Log out\"\n                                            )\n                                        )\n                                    )\n                                )\n                            )\n                        ),\n                        _react2.default.createElement(\n                            \"div\",\n                            { className: _UserPage2.default.menu_navbar_container, style: { color: 'white' } },\n                            _react2.default.createElement(\n                                \"ul\",\n                                { className: _UserPage2.default.main_navigation_navbar },\n                                _react2.default.createElement(\n                                    \"li\",\n                                    null,\n                                    _react2.default.createElement(\n                                        \"a\",\n                                        { onClick: this.openCommunity.bind(this) },\n                                        _react2.default.createElement(\n                                            \"div\",\n                                            { className: _UserPage2.default.navbar_link_container },\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_icon },\n                                                _react2.default.createElement(\"i\", { className: _UserPage2.default.icon_group_chat })\n                                            ),\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_text },\n                                                _react2.default.createElement(\n                                                    \"div\",\n                                                    { className: \"inline middle\", \"ng-bind-html\": \"'COMMUNITY' | translate\" },\n                                                    \"Community\"\n                                                )\n                                            )\n                                        )\n                                    )\n                                ),\n                                _react2.default.createElement(\n                                    \"li\",\n                                    null,\n                                    _react2.default.createElement(\n                                        \"a\",\n                                        { onClick: this.openMessages.bind(this) },\n                                        _react2.default.createElement(\n                                            \"div\",\n                                            { className: _UserPage2.default.navbar_link_container },\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_icon },\n                                                _react2.default.createElement(\"i\", { className: _UserPage2.default.icon_chat_double_bubble })\n                                            ),\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_text },\n                                                _react2.default.createElement(\n                                                    \"div\",\n                                                    { className: \"inline middle\",\n                                                        \"ng-bind-html\": \"'HEADING_MESSAGE' | translate\" },\n                                                    \"Messages\"\n                                                )\n                                            )\n                                        )\n                                    )\n                                ),\n                                _react2.default.createElement(\n                                    \"li\",\n                                    null,\n                                    _react2.default.createElement(\n                                        \"a\",\n                                        { onClick: this.openTests.bind(this) },\n                                        _react2.default.createElement(\n                                            \"div\",\n                                            { className: _UserPage2.default.navbar_link_container },\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_icon },\n                                                _react2.default.createElement(\"i\", { className: _UserPage2.default.icon_test_speaking })\n                                            ),\n                                            _react2.default.createElement(\n                                                \"div\",\n                                                { className: _UserPage2.default.navbar_left_text },\n                                                _react2.default.createElement(\n                                                    \"div\",\n                                                    { className: \"inline middle\",\n                                                        \"ng-bind-html\": \"'HEADING_MESSAGE' | translate\" },\n                                                    \"Go to Test\"\n                                                )\n                                            )\n                                        )\n                                    )\n                                )\n                            )\n                        )\n                    )\n                ),\n                this.state.tab\n            );\n        }\n    }]);\n\n    return UserPage;\n}(_react2.default.Component);\n\nexports.default = UserPage;",{"version":3,"sources":["src/components/UserPage/index.js"],"names":["MainServices","UserServices","UserPage","props","state","avatar","tab","container_app","console","log","user","name","socket","WebSocket","window","FB","api","response","data","url","getUser","setState","error","onopen","onclose","event","wasClean","code","reason","onerror","message","onmessage","JSON","parse","action","body","Text","replace","dispatch","type","on","onGetUserEvent","bind","removeListener","profile","getProfile","user_id","Id","send","stringify","getFriends","getOnlineUsers","facebookLogout","container_app_inbox","navbar_content","navbar_content_main","porfile_navbar","profile_picture_navbar","name_navbar","name_profile_button","color","bold","overflow","whiteSpace","textOverflow","fa_caret_down","menu_navbar_container","main_navigation_navbar","openCommunity","navbar_link_container","navbar_left_icon","icon_group_chat","navbar_left_text","openMessages","icon_chat_double_bubble","openTests","icon_test_speaking","Component"],"mappings":"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","file":"index.js","sourceRoot":"/Users/serqeycheremisin/ieltof","sourcesContent":["import React, {Component} from \"react\";\nimport styles from \"./UserPage.css\";\nimport classNames from \"classnames\";\nimport ChatPage from \"components/ChatPage\";\nimport Community from \"components/Community\";\nimport Tests from \"components/Tests\";\nimport * as MainServices from \"../../services/MainServices\";\nimport * as UserServices from \"../../services/UserServices\";\nimport UserStore from \"../../stores/UserStore\";\nimport dispatcher from \"../../dispatcher\";\n\n\n\nexport default class UserPage extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = this.props;\n        this.state.avatar = \"\";\n        this.state.tab =\n            <div className={classNames({[styles.container_app]: true})}>\n                <Community/>\n            </div>;\n        console.log(this.state.user.name);\n\n        this.socket = new WebSocket(\"wss://cheremisin.info/api/v1/user\");\n        // this.socket = new WebSocket(\"ws://127.0.0.1:8080/api/v1/user\");\n    }\n\n    componentDidMount() {\n        window.FB.api(\n            \"/me/picture\",\n            {\n                \"redirect\": false,\n                \"type\": \"large\"\n            },\n            (response) => {\n                console.log(response)\n                console.log(response.data.url)\n                this.state.avatar = response.data.url;\n\n                UserServices.getUser(this.state);\n                this.setState({})\n                if (response && !response.error) {\n                    /* handle the result */\n                }\n            }\n        );\n\n        this.socket.onopen = () => {\n            console.log(\"Соединение установлено.\");\n        };\n\n        this.socket.onclose = (event) => {\n            if (event.wasClean) {\n                console.log('Соединение закрыто чисто');\n            } else {\n                console.log('Обрыв соединения');\n            }\n            console.log('Код: ' + event.code + ' причина: ' + event.reason);\n        };\n\n        this.socket.onerror = (error) => {\n            console.log(\"Ошибка \" + error.message);\n        };\n\n        this.socket.onmessage = (event) => {\n            console.log(\"Получены данные \" + event.data);\n            let message = JSON.parse(event.data);\n            console.log(\"event\" + event.data);\n\n            switch (message.action) {\n                case 'initMessage':\n                    break;\n\n                case 'sendMessage':\n                    message.body.Text = message.body.Text.replace(/''/g, \"'\");\n                    dispatcher.dispatch({\n                        type: \"REVIEVE_NEW_MESSAGE\",\n                        message: message.body\n                    });\n                    break;\n            }\n        };\n    }\n\n\n    componentWillMount() {\n        UserStore.on(\"get_user_event\", this.onGetUserEvent.bind(this));\n    }\n\n    componentWillUnmount() {\n        UserStore.removeListener(\"get_user_event\", this.onGetUserEvent.bind(this));\n    }\n\n    onGetUserEvent() {\n        let profile = UserStore.getProfile();\n        let message = {\n            type: \"initMessage\",\n            action: \"initMessage\",\n            body: {\n                user_id: profile.Id\n            }\n        };\n        this.socket.send(JSON.stringify(message));\n\n        UserServices.getFriends();\n        UserServices.getOnlineUsers();\n    }\n\n    facebookLogout() {\n        MainServices.facebookLogout();\n    }\n\n    openCommunity() {\n        this.state.tab =\n            <div className={classNames({[styles.container_app]: true})}>\n                <Community/>\n            </div>;\n        this.setState({});\n    }\n\n    openMessages() {\n        this.state.tab =\n            <div className={classNames({\"container-app\": true, [styles.container_app_inbox]: true})}>\n                <ChatPage socket={this.socket}/>\n            </div>;\n        this.setState({});\n    }\n\n    openTests() {\n        this.state.tab =\n            <div className={classNames({[styles.container_app]: true})}>\n                <Tests/>\n            </div>;\n        this.setState({});\n    }\n\n\n    render() {\n        return (\n            <div>\n                <navbar>\n                    <div className={styles.navbar_content}>\n                        <div className={styles.navbar_content_main}>\n                            <div className={styles.porfile_navbar}>\n                                <a>\n                                    <img className={styles.profile_picture_navbar} src={this.state.avatar}/>\n                                </a>\n                                <div className={classNames({\"dropdown\": true, [styles.name_navbar]: true})}>\n                                    <a className={styles.name_profile_button} style={{color: \"#fff\"}} type=\"button\"\n                                       id=\"dropdownMenu1\" data-toggle=\"dropdown\" aria-haspopup=\"true\"\n                                       aria-expanded=\"true\">\n                                        <div className={styles.bold} style={{\n                                            overflow: 'hidden',\n                                            whiteSpace: 'nowrap',\n                                            textOverflow: 'ellipsis'\n                                        }}>\n                                            {this.state.user.name} <i className={classNames({\n                                            \"fa\": true,\n                                            \"fa-caret-down\": true,\n                                            [styles.fa_caret_down]: true\n                                        })}></i></div>\n                                    </a>\n                                    <ul className={classNames({\"dropdown-menu\": true})} aria-labelledby=\"dropdownMenu1\">\n                                        {/*<li><a href=\"/buddies/\">Friends</a>*/}\n                                        {/*</li>*/}\n                                        {/*<li><a href=\"/settings/\"*/}\n                                        {/*ng-bind-html=\"'NAVBAR_SETTINGS' | translate\">Settings</a></li>*/}\n                                        {/*<li role=\"separator\" class=\"hl\"></li>*/}\n                                        {/*<li><a report-problem=\"\" report-from=\"Navbar\">Report a problem</a></li>*/}\n                                        <li><a logout=\"\" onClick={this.facebookLogout.bind(this)}>Log out</a>\n                                        </li>\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                        <div className={styles.menu_navbar_container} style={{color: 'white'}}>\n                            <ul className={styles.main_navigation_navbar}>\n                                <li>\n                                    <a onClick={this.openCommunity.bind(this)}>\n                                        <div className={styles.navbar_link_container}>\n                                            <div className={styles.navbar_left_icon}>\n                                                <i className={styles.icon_group_chat}></i>\n                                                {/*<i className=\"icon-set-1 icon-group-chat middle\"></i>*/}\n                                            </div>\n                                            <div className={styles.navbar_left_text}>\n                                                <div className=\"inline middle\" ng-bind-html=\"'COMMUNITY' | translate\">\n                                                    Community\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </a>\n                                </li>\n                                <li>\n                                    <a onClick={this.openMessages.bind(this)}>\n                                        <div className={styles.navbar_link_container}>\n                                            <div className={styles.navbar_left_icon}>\n                                                <i className={styles.icon_chat_double_bubble}></i>\n                                                {/*<i className=\"icon-set-1 icon-chat-double-bubble middle\"></i>*/}\n                                            </div>\n                                            <div className={styles.navbar_left_text}>\n                                                <div className=\"inline middle\"\n                                                     ng-bind-html=\"'HEADING_MESSAGE' | translate\">Messages\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </a>\n                                </li>\n                                <li>\n                                    <a onClick={this.openTests.bind(this)}>\n                                        <div className={styles.navbar_link_container}>\n                                            <div className={styles.navbar_left_icon}>\n                                                <i className={styles.icon_test_speaking}></i>\n                                                {/*<i className=\"icon-set-1 icon-chat-double-bubble middle\"></i>*/}\n                                            </div>\n                                            <div className={styles.navbar_left_text}>\n                                                <div className=\"inline middle\"\n                                                     ng-bind-html=\"'HEADING_MESSAGE' | translate\">Go to Test\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </navbar>\n                {this.state.tab}\n            </div>\n        )\n    }\n}\n\n"]}]}